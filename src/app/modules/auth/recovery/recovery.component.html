<div class="w-full h-full">
  <header
    class="w-full h-[12%] bg-nile-blue flex flex-col items-center justify-center"
  >
    <h1 class="text-cameo font-bold text-xl uppercase">Recuperar contraseña</h1>
    <p class="text-cameo text-base" *ngIf="!emailSent">
      Ingresa tu correo electrónico y te enviaremos un código para que puedas
      recuperar tu contraseña.
    </p>
    <p class="text-cameo text-base" *ngIf="emailSent && !codeSent">
      Ingresa el código que te enviamos a tu correo electrónico.
    </p>
    <p class="text-cameo text-base" *ngIf="codeSent && codeValidate">
      Ingresa tu nueva contraseña.
    </p>
  </header>

  <div
    class="w-full h-[88%] bg-gradient-to-bl from-gold via-hampton to-cooper-rost flex items-center justify-center"
  >
    <!-- Envia el correo para ser validado -->
    <form
      class="w-[29%] h-[32%] border-nile-blue-200 border-2 rounded-xl shadow-xl shadow-black-200 flex flex-col items-center justify-center"
      *ngIf="!emailSent"
      [formGroup]="this.recoverForm"
      (ngSubmit)="sendRecover()"
    >
      <div
        class="w-full h-[20%] flex items-center justify-center text-lg text-nile-blue uppercase"
      >
        <h1
          class="bg-gold bg-opacity-30 shadow-sm shadow-cooper-rost rounded-xl px-3 py-1"
        >
          Solicitar código
        </h1>
      </div>
      <div
        class="w-full h-[50%] flex flex-col items-center justify-center px-2"
      >
        <div class="w-full h-[70%] flex items-end justify-end">
          <label class="w-1/2 text-nile-blue text-xl py-2 pr-2" for="email"
            >Correo electrónico:
          </label>
          <input
            class="w-1/2 h-10 bg-none border-1 border-black-100 rounded-xl pl-2 text-sm"
            type="email"
            formControlName="email"
            (focus)="onEmailInputFocus()"
            placeholder="Ingresa el correo electrónico"
          />
        </div>
        <div class="w-full h-[30%] pl-[50%] flex-col flex">
          <div
            *ngIf="
              this.recoverForm.get('email')?.invalid &&
              this.recoverForm.get('email')?.touched
            "
            class="w-full text-red-200 text-xs rounded py-1 flex px-1"
            role="alert"
          >
            <div
              class="w-full py-1 flex items-center justify-start"
              *ngIf="this.recoverForm.get('email')?.errors?.['email']"
            >
              <i class="fas fa-exclamation-triangle"></i>Correo electrónico
              inválido
            </div>
            <div
              class="w-full py-1 flex items-center justify-start"
              *ngIf="
this.recoverForm.get('email')?.errors?.['required'] &&
this.recoverForm.get('email')?.touched
"
            >
              <i class="fas fa-exclamation-triangle pr-1"></i>
              Email requerido
            </div>
          </div>
          <div
            *ngIf="this.error"
            class="alert alert-danger"
            role="alert"
            style="color: red"
          >
            {{ this.errorMessage }}
          </div>
        </div>
      </div>
      <!-- Si error  es diferente de false y si errorMessage diferente de '' -->
      <div class="w-full h-[30%] flex items-start justify-center">
        <!-- Este se divide en tres partes iguales -->
        <div class="flex justify-center items-center w-1/2 px-2">
          <button
            (click)="goBack()"
            class="border-2 rounded-lg px-2 py-2 text-base text-nile-blue-200 font-bold border-nile-blue hover:bg-nile-blue hover:text-cameo"
          >
            Inicio
          </button>
        </div>
        <div class="flex justify-center items-center w-1/2 px-2">
          <button
            [disabled]="recoverForm.invalid"
            type="submit"
            class="border-2 border-nile-blue rounded-lg py-2 px-2 text-base text-nile-blue flex items-end justify-end hover:text-cameo hover:bg-nile-blue-200"
          >
            Enviar código
          </button>
        </div>

        <!--  -->
      </div>
    </form>

    <!-- Envia el codigo para ser validado -->
    <form
      *ngIf="codeSent"
      [formGroup]="this.formCode"
      (ngSubmit)="validateCode()"
      class="w-[30%] h-[32%] border-nile-blue-200 border-2 rounded-xl shadow-xl shadow-black-200 flex flex-col"
    >
      <div
        class="w-full h-[20%] flex flex-col items-center justify-center text-base text-nile-blue-200"
      >
        <h1>Ingresa el código que te enviamos a tu correo electrónico.</h1>
      </div>

      <div
        class="w-full h-[50%] flex justify-center items-center space-x-2"
        id="recover"
      >
        <input
          type="text"
          class="w-[15%] h-[40%] text-nile-blue font-bold px-1 text-center rounded-lg"
          id="code1"
          formControlName="code1"
          [ngClass]="{ 'placeholder-blink': emailSent }"
          placeholder="-"
          maxlength="1"
          (keyup)="focus('code2', $event)"
        />

        <input
          type="text"
          class="w-[15%] h-[40%] text-nile-blue font-bold px-1 text-center rounded-lg"
          id="code2"
          formControlName="code2"
          [ngClass]="{ 'placeholder-blink': emailSent }"
          placeholder="-"
          maxlength="1"
          (keyup)="focus('code3', $event)"
        />

        <input
          type="text"
          class="w-[15%] h-[40%] text-nile-blue font-bold px-1 text-center rounded-lg"
          id="code3"
          formControlName="code3"
          [ngClass]="{ 'placeholder-blink': emailSent }"
          placeholder="-"
          maxlength="1"
          (keyup)="focus('code4', $event)"
        />

        <input
          type="text"
          class="w-[15%] h-[40%] text-nile-blue font-bold px-1 text-center rounded-lg"
          id="code4"
          formControlName="code4"
          [ngClass]="{ 'placeholder-blink': emailSent }"
          placeholder="-"
          maxlength="1"
          (keyup)="focus('code5', $event)"
        />

        <input
          type="text"
          class="w-[15%] h-[40%] text-nile-blue font-bold px-1 text-center rounded-lg"
          id="code5"
          formControlName="code5"
          [ngClass]="{ 'placeholder-blink': emailSent }"
          placeholder="-"
          maxlength="1"
          (keyup)="focus('code6', $event)"
        />

        <input
          type="text"
          class="w-[15%] h-[40%] text-nile-blue font-bold px-1 text-center rounded-lg"
          id="code6"
          formControlName="code6"
          [ngClass]="{ 'placeholder-blink': emailSent }"
          placeholder="-"
          maxlength="1"
        />
      </div>

      <div class="w-full h-[30%] flex items-center justify-center">
        <div
          *ngIf="this.error"
          class="alert alert-danger text-red-500"
          role="alert"
        >
          {{ this.errorMessage }}
        </div>
        <button
          [disabled]="this.formCode.invalid"
          type="submit"
          class="border-2 border-nile-blue rounded-lg py-2 px-2 text-base text-nile-blue flex items-end justify-end hover:text-cameo hover:bg-nile-blue-200"
        >
          Verificar código
        </button>
      </div>
    </form>

    <!-- Formulario para establecer una nueva contraseña -->
    <!-- Formulario para establecer una nueva contraseña -->
    <form
      *ngIf="this.codeValidate"
      [formGroup]="formPassword"
      (ngSubmit)="savePassword()"
      class="w-[30%] h-[38%] border-nile-blue-200 border-2 rounded-xl shadow-xl shadow-black-200 flex flex-col"
    >
      <div
        class="w-full h-[20%] flex items-center justify-center text-lg text-nile-blue uppercase"
      >
        <h1
          class="bg-gold bg-opacity-30 shadow-sm shadow-cooper-rost rounded-xl px-2 py-1"
        >
          Ingresa la nueva contraseña
        </h1>
      </div>
      <div class="grid grid-cols-2 gap-2 py-2">
        <div class="col-span-1 text-base text-nile-blue">
          <label for="password">Nueva contraseña: </label>
        </div>
        <div class="col-span-1">
          <input
            type="password"
            class="rounded-lg"
            id="password"
            (input)="verificarFortalezaContrasena()"
            formControlName="password"
            [type]="showPassword ? 'text' : 'password'"
          />
          <div class="flex py-1 text-xs justify-start items-center">
            <label>Control de seguridad:</label>
            <i
              [style.color]="tieneMayusculas ? '#96A16F' : '#373737'"
              class="fa fa-circle px-1 cursor-help"
              [title]="
                tieneMayusculas ? 'Tiene mayúsculas' : 'Se requieren mayúsculas'
              "
            ></i>
            <i
              [style.color]="tieneMinusculas ? '#96A16F' : '#373737'"
              class="fa fa-circle px-1 cursor-help"
              [title]="
                tieneMinusculas ? 'Tiene minúsculas' : 'Se requieren minúsculas'
              "
            ></i>
            <i
              [style.color]="tieneNumeros ? '#96A16F' : '#373737'"
              class="fa fa-circle px-1 cursor-help"
              [title]="tieneNumeros ? 'Tiene números' : 'Se requieren números'"
            ></i>
            <i
              [style.color]="esLarga ? '#96A16F' : '#373737'"
              class="fa fa-circle px-1 cursor-help"
              [title]="
                esLarga
                  ? 'Tiene más de 8 caracteres'
                  : 'Se requieren más de 8 caracteres'
              "
            ></i>
          </div>
          <div class="flex items-center justify-start">
            <input
              id="remember_me"
              (change)="showPassword = !showPassword"
              type="checkbox"
              class="h-3 w-3 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
            />
            <label for="remember_me" class="ml-2 block text-xs text-nile-blue">
              Mostrar contraseña
            </label>
          </div>
        </div>
      </div>
      <div class="grid grid-cols-2 gap-2 py-2">
        <div class="col-span-1 text-base text-nile-blue">
          <label for="repeatPassword">Repetir contraseña: </label>
        </div>
        <div class="col-span-1">
          <input
            type="password"
            class="rounded-lg"
            id="repeatPassword"
            formControlName="repeatPassword"
            [type]="showPassword2 ? 'text' : 'password'"
          />
          <div class="flex items-center justify-start py-2">
            <input
              id="remember"
              (change)="showPassword2 = !showPassword2"
              type="checkbox"
              class="h-3 w-3 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
            />
            <label for="remember" class="ml-2 block text-xs text-nile-blue">
              Mostrar contraseña
            </label>
          </div>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-2 py-2">
        <div class="col-span-1">
          <button
            (click)="goBack()"
            type="submit"
            class="border-2 border-nile-blue rounded-lg py-2 px-2 text-base text-nile-blue flex items-end justify-end hover:text-cameo hover:bg-nile-blue-200"
          >
            Inicio
          </button>
        </div>
        <div class="col-span-1">
          <button
            [disabled]="this.formPassword.invalid"
            type="submit"
            class="border-2 border-nile-blue rounded-lg py-2 px-2 text-base text-nile-blue flex items-end justify-end hover:text-cameo hover:bg-nile-blue-200"
          >
            Guardar
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
